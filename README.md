# CVE-2019-11043
1.漏洞描述
Nginx上fastcgi split path info 在处理带有%0a的请求时,会因为遇到换行符\n导致PATH INFO为空。而php-fpm在处理PATH INFO为空的情况下，存在逻辑缺陷。攻击者通过精心的构造和利用，可以导致远程代码执行。

影响范围

Nginx + php-fpm 的服务器,在使用如下配置的情况下，都可能存在远程代码执行漏洞。

location ~ [^ /小.php(/|$) {

fastcgi split path info ^(.+ ?\.php)(.*)$;

fastcgi param PATH INFO $fastcgi path info;fastcgi pass php:9000;



}

2.漏洞检测
方案一：利用 phuip-fpizdam脚本检测

0x01 安装 phuip-fpizdam-Mac
go get github.com/neex/phuip-fpizdam

go install github.com/neex/phuip-fpizdam
➜  ~ cd ./go

➜  go go get github.com/neex/phuip-fpizdam

➜  go go install github.com/neex/phuip-fpizdam





➜  go ls

bin src

➜  go cd bin

➜  bin ls

phuip-fpizdam

➜  bin file phuip-fpizdam 

phuip-fpizdam: Mach-O 64-bit executable x86_64

➜  bin ls -lah phuip-fpizdam 

-rwxr-xr-x  1 alewong  staff   9.3M 10 24 10:54 phuip-fpizdam

